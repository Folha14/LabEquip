@using LabEquip.Models
@model IEnumerable<Utilizador>
@{
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <link rel="stylesheet" href="/css/labequip.css" />
    <title>Gestão de Utilizadores</title>
</head>
<body>
    <h1>👥 Gestão de Utilizadores (BackEnd)</h1>

    <div class="links">
        <p>🏠 <a href="/Equipamento/Index">Voltar aos Equipamentos</a></p>
        <p>➕ <a href="/Equipamento/CriarUtilizador">Criar Utilizador</a></p>
        <p>🚪 <a href="/Conta/Logout">Sair</a></p>
    </div>

    <table>
        <tr>
            <th>Guid</th>
            <th>Nome</th>
            <th>Email</th>
            <th class="center">Nível</th>
            <th class="center">Estado</th>
            <th class="center">Data Registo</th>
            <th class="center">Operações</th>
        </tr>
        @foreach (var item in Model)
        {
            <tr>
                <td>@item.GuidUtilizador</td>
                <td>@item.Nome</td>
                <td>@item.Email</td>
                <td class="center">
                    @(item.NivelAcesso == 0 ? "Visitante" :
                        item.NivelAcesso == 1 ? "Utilizador" : "Administrador")
                </td>
                <td class="center">@(item.Ativo ? "Ativo" : "Inativo")</td>
                <td class="center">@item.DthrRegisto.ToString("dd/MM/yyyy")</td>
                <td class="center">
                    <a href="/Equipamento/DetalheUtilizador/@item.GuidUtilizador">Detalhe</a>
                    | <a href="/Equipamento/EditarUtilizador/@item.GuidUtilizador">Editar</a>
                    @if (item.Ativo)
                    {
                        @: | <a href="/Equipamento/DesativarUtilizador/@item.GuidUtilizador">Desativar</a>
                    }
                    else
                    {
                        @: | <a href="/Equipamento/AtivarUtilizador/@item.GuidUtilizador">Ativar</a>
                    }
                    @if (item.NivelAcesso < 2)
                    {
                        @: | <a href="/Equipamento/PromoverUtilizador/@item.GuidUtilizador">Promover</a>
                    }
                    @if (item.NivelAcesso > 0)
                    {
                        @: | <a href="/Equipamento/DespromoverUtilizador/@item.GuidUtilizador">Despromover</a>
                    }
                    | <a href="/Equipamento/MatarUtilizador/@item.GuidUtilizador">Eliminar</a>
                </td>
            </tr>
        }
    </table>

    <table class="summary-table" style="margin-top: 30px;">
        <tr style="background-color: #e8f4fd; font-weight: bold;">
            <td>👥 Total de Utilizadores Ativos:</td>
            <td>@ViewBag.TotalUtilizadoresAtivos</td>
        </tr>
        <tr style="background-color: #e8f8e8;">
            <td>🆕 Utilizador Mais Recente:</td>
            <td>@ViewBag.UtilizadorMaisRecente</td>
        </tr>
        <tr style="background-color: #fff2e8;">
            <td>🎭 Distribuição por Níveis:</td>
            <td>@ViewBag.ContagemNiveis</td>
        </tr>
    </table>

    <div class="user-info">
        👤 Administrador: @ViewBag.Conta.Nome &nbsp;&nbsp;|&nbsp;&nbsp; ✉️ Contacto: @ViewBag.Conta.Email
    </div>
</body>
</html>